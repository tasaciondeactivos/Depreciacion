
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Experimento Timer vs Hash</title>
</head>
<body style="text-align: center; font-family: monospace; padding-top: 50px;">

    <h1>TEST DE CONFLICTO</h1>
    
    <div style="font-size: 30px; margin-bottom: 20px;">
        Tiempo para cierre: <span id="segundos">10</span>s
    </div>

    <input type="password" id="pass" placeholder="Escribe aquí">
    <button onclick="probarHash()">PROBAR ENCRIPTACIÓN</button>

    <p id="status" style="margin-top: 20px; color: blue;"></p>

    <script>
        let segundosRestantes = 10;
        const display = document.getElementById('segundos');
        const status = document.getElementById('status');

        // 1. EL TIMER: Se ejecuta cada segundo sin falta
        const intervalo = setInterval(() => {
            segundosRestantes--;
            display.innerText = segundosRestantes;
            
            if (segundosRestantes <= 0) {
                status.innerText = "¡TIMER AGOTADO! (Simulación de reinicio)";
                status.style.color = "red";
                // Aquí es donde en el original se hace location.reload()
                clearInterval(intervalo);
            }
        }, 1000);

        // 2. LA ENCRIPTACIÓN: Vamos a ver si esto detiene el reloj arriba
        async function probarHash() {
            const texto = document.getElementById('pass').value;
            status.innerText = "Encriptando...";
            
            // Proceso SHA-256
            const utf8 = new TextEncoder().encode(texto);
            const hashBuffer = await crypto.subtle.digest('SHA-256', utf8);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashFinal = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            
            status.innerText = "Hash generado: " + hashFinal.substring(0, 10) + "...";
            console.log("Hash completo:", hashFinal);
        }
    </script>
</body>
</html>
